version: "3.9"

services:
  openhub:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: openhub
    environment:
      - NODE_ENV=production
      - NEXT_TELEMETRY_DISABLED=1
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - MODEL_HASH_SECRET=${MODEL_HASH_SECRET}
      # App URLs (frontend)
      - NEXT_PUBLIC_REASONING_URL=https://reasoning.trott.dev
      - NEXT_PUBLIC_ALTGEN_URL=https://altgen.trott.dev
      - NEXT_PUBLIC_MORPHIC_URL=https://morphic.trott.dev
      # App URLs (node scripts)
      - REASONING_URL=https://reasoning.trott.dev
      - ALTGEN_URL=https://altgen.trott.dev
      - MORPHIC_URL=https://morphic.trott.dev
    ports:
      - "3000:3000"
    depends_on: []
    restart: unless-stopped

  reasoning:
    build:
      context: ./templates/ai-sdk-reasoning-starter
      dockerfile: Dockerfile
    container_name: reasoning
    environment:
      - NODE_ENV=production
      - NEXT_TELEMETRY_DISABLED=1
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - NEXT_PUBLIC_APP_URL=https://reasoning.trott.dev
      - NEXT_PUBLIC_APP_NAME=Reasoning
    ports:
      - "3001:3001"
    restart: unless-stopped
    depends_on:
      - openhub

  altgen:
    build:
      context: ./templates/alt-tag-generator
      dockerfile: Dockerfile
    container_name: altgen
    environment:
      - NODE_ENV=production
      - NEXT_TELEMETRY_DISABLED=1
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - NEXT_PUBLIC_BASE_URL=https://altgen.trott.dev
    ports:
      - "3002:3002"
    restart: unless-stopped
    depends_on:
      - openhub

  morphic:
    build:
      context: ./templates/morphic
      dockerfile: Dockerfile
    container_name: morphic
    environment:
      - NODE_ENV=production
      - NEXT_TELEMETRY_DISABLED=1
      # Shared
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      # Base URLs
      - NEXT_PUBLIC_BASE_URL=https://morphic.trott.dev
      - BASE_URL=https://morphic.trott.dev
      # Supabase
      - NEXT_PUBLIC_SUPABASE_URL=${NEXT_PUBLIC_SUPABASE_URL}
      - NEXT_PUBLIC_SUPABASE_ANON_KEY=${NEXT_PUBLIC_SUPABASE_ANON_KEY}
      - TAVILY_API_KEY=${TAVILY_API_KEY}
    ports:
      - "3003:3003"
    restart: unless-stopped
    depends_on:
      - openhub


